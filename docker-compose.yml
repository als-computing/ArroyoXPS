
version: "3.3"
services:
  tiled:
    # see the file ./tiled/deploy/config.yml for detailed configuration of tiled
    image: ghcr.io/bluesky/tiled:v0.1.0a122
    ports:
      - "8000:8000"
    environment:
      - TILED_SINGLE_USER_API_KEY=${TILED_SINGLE_USER_API_KEY}
    volumes:
      - ./services/tiled/deploy:/deploy:Z
      - ./data:/data:Z
    restart: unless-stopped
    networks:
      aps_net:

  processor:
    # command: python -m tr_ap_xps.processor.cli --zmq-pub-address tcp://simulator
    command: sleep 888888
    build:
      context: .
      dockerfile: Dockerfile_processor
    restart: unless-stopped
    volumes:
      - .:/app:Z
    networks:
      aps_net:

  wspublisher:
    command: sleep 9899999
    build:
      context: .
      dockerfile: Dockerfile_wspublisher
    restart: unless-stopped
    volumes:
      - .:/app:Z
    networks:
      aps_net:


  simulator:
    build:
      context: .
      dockerfile: Dockerfile_labviewsim
    restart: unless-stopped
    volumes:
      - .:/app
      - /home/dmcreynolds/scan2:/app/sample_data/pickled_scan
    networks:
      aps_net:
networks:
  aps_net:
    driver: bridge
